# -- Global SSO values used for BigBang deployments when sso is enabled
sso:
  # -- Name of the identity provider
  name: keycloak
  # -- Hostname of the identity provider
  host: login.dso.mil  ### TBD ###
  # -- Port of the identify provider service
  port: 443  ### TBD ###
  # -- Identity provider realm
  realm: baby-yoda  ### TBD ###
  # -- Base URL for the identity provider. For OIDC, this is the issuer.  For SAML this is the entityID. Use {{ tpl .Values.sso.url . }} to generate
  url: "https://{{ .Values.sso.host }}:{{ .Values.sso.port }}/auth/realms/{{ .Values.sso.realm }}"
  # -- Certificate authority for the identity provider's certificates
  certificateAuthority:
    # -- The certificate authority public certificate in .pem format.  Populating this will create a secret in each namespace that enables SSO.
    cert:
    # -- The secret name to use for the certificate authority.  Can be manually populated if cert is blank.
    secretName: sso-certificate-authority
  # -- Public X.509 certificate used by the IdP to authenticate messages.  Can be found at `{{ .Values.sso.url }}/{{ .Values.sso.saml.entityDescriptor }}` or `{{ .Values.sso.url }}/{{ .Values.sso.oidc.jwksUri }}`.  Some packages cannot dynammically retrieve the cert.
  certificate: ### TBD ###
    # -- The public x.509 certificate.  Populating this will create a secret in each namespace for SSO.
    cert:  ### TBD ###
    # -- The secret name to use for the certificate.  Can be manually populated if cert is blank.
    secretName: sso-certificate ### TBD ###
  saml:
    # -- SAML entityDescriptor (metadata) relative path
    entityDescriptor: protocol/saml/descriptor
    # -- SAML singleSignOnService relative path
    singleSignOnService: protocol/saml
    # -- SAML singleLogoutService relative path
    singleLogoutService: protocol/saml
  # -- OIDC endpoints can be retrieved from `{{ .Values.sso.url }}/.well-known/openid-configuration`
  oidc:
    # -- OIDC authorization relative path
    authorization: protocol/openid-connect/auth
    # -- OIDC logout / end session relative path
    endSession: protocol/openid-connect/logout
    # -- OIDC JSON Web Key Set (JWKS) relative path
    jwksUri: protocol/openid-connect/certs
    # -- OIDC token relative path
    token: protocol/openid-connect/token
    # -- OIDC user information relative path
    userinfo: protocol/openid-connect/userinfo
  # -- Identity provider attributes that store metadata about the authenticated user.
  attributes:
    # -- IdP's attribute name used for the user's email address.
    email: email
    ## -- IdP's attribute name used for the user's first name
    firstname: given_name
    ## -- IdP's attribute name used for the user's last name
    lastname: family_name
    # -- IdP's attribute name used for the user's full name
    name: name
    # -- IdP's attribute name used for the username
    username: preferred_username
    # -- IdP's attribute name used for the user's group or role
    group:

# -- Wrapper chart for integrating Big Bang into a package
wrapper:
  git:
    # -- Git repo holding the wrapper helm chart
    repo: https://repo1.dso.mil/platform-one/big-bang/apps/wrapper
    # -- Path inside of the git repo to find the helm chart
    path: chart
    # -- Git tag to check out.  Takes precedence over branch. [More info](https://fluxcd.io/flux/components/source/gitrepositories/#reference)
    tag:
    branch: main

# -- Packages to deploy with Big Bang integration
# @default - '{}'
packages:
  # -- Package name.  Each package will be independently wrapped for Big Bang integration.
  # @default -- Uses `defaults/<package name>.yaml` for defaults.  See `package` Helm chart for additional values that can be set.
  sample:
    # -- Toggle deployment of this package
    # @default -- true
    enabled: false
    # -- Use a kustomize deployment rather than Helm
    kustomize: false

    git:
      # -- (Required) Git repo URL holding the helm chart for this package
      repo:
      # -- Git commit to check out.  Takes precedence over semver, tag, and branch. [More info](https://fluxcd.io/flux/components/source/gitrepositories/#reference)
      commit:
      # -- Git semVer tag expression to check out.  Takes precedence over tag. [More info](https://fluxcd.io/flux/components/source/gitrepositories/#reference)
      semver:
      # -- Git tag to check out.  Takes precedence over branch. [More info](https://fluxcd.io/flux/components/source/gitrepositories/#reference)
      tag:
      # -- Git branch to check out.  [More info](https://fluxcd.io/flux/components/source/gitrepositories/#reference).
      # @default -- When no other reference is specified, `master` branch is used
      branch:
      # -- Path inside of the git repo to find the helm chart or kustomize
      # @default -- For Helm charts `chart`.  For Kustomize `/`.
      path:

    # -- Override flux settings for this package
    flux: {}

    # -- After deployment, patch resources.  [More info](https://fluxcd.io/flux/components/helm/helmreleases/#post-renderers)
    postRenderers: []

    # -- Package details for Istio.  See [wrapper values](https://repo1.dso.mil/platform-one/big-bang/apps/wrapper/-/blob/main/chart/values.yaml) for settings.
    istio: {}

    # -- Package details for monitoring.  See [wrapper values](https://repo1.dso.mil/platform-one/big-bang/apps/wrapper/-/blob/main/chart/values.yaml) for settings.
    monitor: {}

    # -- Package details for network policies.  See [wrapper values](https://repo1.dso.mil/platform-one/big-bang/apps/wrapper/-/blob/main/chart/values.yaml) for settings.
    network: {}

    # -- Secrets that should be created prior to package installation.  See [wrapper values](https://repo1.dso.mil/platform-one/big-bang/apps/wrapper/-/blob/main/chart/values.yaml) for settings.
    secrets: {}

    # -- ConfigMaps that should be created prior to package installation.  See [wrapper values](https://repo1.dso.mil/platform-one/big-bang/apps/wrapper/-/blob/main/chart/values.yaml) for settings.
    configMaps: {}

    # -- Values to pass through to package Helm chart
    values: {}