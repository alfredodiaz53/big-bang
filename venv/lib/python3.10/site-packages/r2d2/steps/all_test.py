# Note that the filename all_test.py is *magic* and is referenced in r2d2/cli.py. If you rename
# this file you need to rename that usage as well.
import importlib

from . import __all_tests__

class R2D2Step:
    step = "Run All Tests (Automatically Selects Other Tests)"
    # this is what is shown in the CLI options

    def __init__(self, repo, repo1, console, config):
        self.repo = repo
        self.repo1 = repo1
        self.console = console
        self.config = config

    def prerun(self):
        # Ensure that all test steps are selected
        unselected_tests = list(test for test in __all_tests__ if test not in self.config["steps"])
        for test_name in unselected_tests:
            self.config["steps"].append(test_name)
        self.console.info(f"Automatically selecting {len(unselected_tests)} unselected tests")

    def run(self):
        # Do nothing; all we care about doing is already done in prerun
        pass
